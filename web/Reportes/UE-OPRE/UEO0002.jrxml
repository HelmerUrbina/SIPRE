<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="UEO0002" pageWidth="612" pageHeight="781" whenNoDataType="AllSectionsNoDetail" columnWidth="552" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="34" uuid="ed9dd4bb-cf1e-442b-bafa-872186b21025">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.500000000000002"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="CODIGO" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["0000750"]]></defaultValueExpression>
	</parameter>
	<parameter name="PERIODO" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["2020"]]></defaultValueExpression>
	</parameter>
	<parameter name="PRESUPUESTO" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["1"]]></defaultValueExpression>
	</parameter>
	<parameter name="MES" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["03"]]></defaultValueExpression>
	</parameter>
	<parameter name="USUARIO" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["320432400"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT CODPER AS PERIODO, COPPTO,   
COPPTO||':'||UTIL_NEW.FUN_DEPPTO(COPPTO) AS FUENTE_FINANCIAMIENTO,
UTIL_NEW.FUN_ABUUOO(COUUOO) AS UNIDAD, 
TIPO, CONCEPTO,   
SUM(INICIAL) AS INICIAL, SUM(INGRESOS) AS INGRESOS, SUM(EGRESOS) AS EGRESOS, 
SUM(INICIAL+INGRESOS) AS TOTAL_INGRESOS, SUM(INICIAL+INGRESOS+EGRESOS) AS IMPORTE,
CASE WHEN $P{USUARIO} IN ('10714635','43305891','44469132') THEN 'Sección Telemática - OPRE' ELSE 
UTIL_NEW.FUN_DESC_USUARIO($P{USUARIO}) END AS USU_IMPRESION
FROM(
SELECT CODPER, COPPTO, COUUOO, 
UTIL_NEW.FUN_NTAREA(COMEOP) CONCEPTO, TRIM(CODGEN) AS CODGEN, 'INGRESOS INICIALES' AS TIPO, 1 AS CODIGO,
SUM(CASE MODEPA WHEN 0 THEN IMPORT ELSE 0 END) AS INICIAL, 0 INGRESOS, 0 EGRESOS
FROM MODEPA WHERE 
CODPER>='2020' AND
COUUOO='0003' AND COPPTO='1' AND MODEPA=0
GROUP BY CODPER, COPPTO, COUUOO, COMEOP, CODGEN
HAVING SUM(IMPORT)!=0
UNION ALL
SELECT NM.CPERIODO_CODIGO AS CODPER, ND.NPRESUPUESTO_CODIGO AS COPPTO, NM.CUNIDAD_OPERATIVA_CODIGO AS COUUOO, 
TRIM(NM.VNOTA_MODIFICATORIA_JUSTIFICAC) AS CONCEPTO, SUBSTR(VCADENA_GASTO_CODIGO,3,1) AS CODGEN, 'INGRESOS' AS TIPO, 2 AS CODIGO,
0 INICIAL, SUM(ND.NNOTA_MODIFICATORIA_IMPORTE) INGRESOS, 0 EGRESOS
FROM SIPE_NOTA_MODIFICATORIA NM INNER JOIN SIPE_NOTA_MODIFICATORIA_DETAL ND ON (
NM.CPERIODO_CODIGO=ND.CPERIODO_CODIGO AND 
NM.CUNIDAD_OPERATIVA_CODIGO=ND.CUNIDAD_OPERATIVA_CODIGO AND 
NM.NNOTA_MODIFICATORIA_CODIGO=ND.NNOTA_MODIFICATORIA_CODIGO) WHERE 
NM.CPERIODO_CODIGO>='2020' AND ND.NPRESUPUESTO_CODIGO=1 AND ND.CNOTA_MODIFICATORIA_TIPO='C' AND
ND.CUNIDAD_CODIGO='0003' AND CNOTA_MODIFICATORIA_ESTADO IN ('EN')
GROUP BY NM.CPERIODO_CODIGO,NM.CUNIDAD_OPERATIVA_CODIGO,ND.NPRESUPUESTO_CODIGO,
NM.NNOTA_MODIFICATORIA_CODIGO, SUBSTR(VCADENA_GASTO_CODIGO,3,1),
TRIM(NM.VNOTA_MODIFICATORIA_JUSTIFICAC), CNOTA_MODIFICATORIA_TIPO
HAVING SUM(ND.NNOTA_MODIFICATORIA_IMPORTE)!=0 
UNION ALL
SELECT NM.CPERIODO_CODIGO AS CODPER, ND.NPRESUPUESTO_CODIGO AS COPPTO, ND.CUNIDAD_CODIGO AS COUUOO,
TRIM(NM.VNOTA_MODIFICATORIA_JUSTIFICAC) AS CONCEPTO, SUBSTR(VCADENA_GASTO_CODIGO,3,1) AS CODGEN, 'EGRESOS' AS TIPO, 3 AS CODIGO,
0 INICIAL, 0 INGRESOS, SUM(ND.NNOTA_MODIFICATORIA_IMPORTE*(-1)) AS EGRESOS
FROM SIPE_NOTA_MODIFICATORIA NM INNER JOIN SIPE_NOTA_MODIFICATORIA_DETAL ND ON (
NM.CPERIODO_CODIGO=ND.CPERIODO_CODIGO AND 
NM.CUNIDAD_OPERATIVA_CODIGO=ND.CUNIDAD_OPERATIVA_CODIGO AND 
NM.NNOTA_MODIFICATORIA_CODIGO=ND.NNOTA_MODIFICATORIA_CODIGO) WHERE 
NM.CPERIODO_CODIGO>='2020' AND ND.NPRESUPUESTO_CODIGO=1 AND ND.CNOTA_MODIFICATORIA_TIPO='C' AND
NM.CUNIDAD_OPERATIVA_CODIGO='0003' AND ND.CUNIDAD_CODIGO!='0003' AND CNOTA_MODIFICATORIA_ESTADO IN ('EN') 
GROUP BY NM.CPERIODO_CODIGO,NM.CUNIDAD_OPERATIVA_CODIGO,ND.NPRESUPUESTO_CODIGO,
SUBSTR(VCADENA_GASTO_CODIGO,3,1), TRIM(NM.VNOTA_MODIFICATORIA_JUSTIFICAC), ND.CUNIDAD_CODIGO
HAVING SUM(ND.NNOTA_MODIFICATORIA_IMPORTE)!=0 )
WHERE CODPER=$P{PERIODO} AND COPPTO=$P{PRESUPUESTO}
GROUP BY CODPER, COPPTO, COUUOO, CONCEPTO, CODIGO, TIPO
ORDER BY CODIGO, CONCEPTO, COUUOO]]>
	</queryString>
	<field name="PERIODO" class="java.lang.String"/>
	<field name="COPPTO" class="java.math.BigDecimal"/>
	<field name="FUENTE_FINANCIAMIENTO" class="java.lang.String"/>
	<field name="UNIDAD" class="java.lang.String"/>
	<field name="TIPO" class="java.lang.String"/>
	<field name="CONCEPTO" class="java.lang.String"/>
	<field name="INICIAL" class="java.math.BigDecimal"/>
	<field name="INGRESOS" class="java.math.BigDecimal"/>
	<field name="EGRESOS" class="java.math.BigDecimal"/>
	<field name="TOTAL_INGRESOS" class="java.math.BigDecimal"/>
	<field name="IMPORTE" class="java.math.BigDecimal"/>
	<field name="USU_IMPRESION" class="java.lang.String"/>
	<variable name="SUM_TOTCOB_U" class="java.math.BigDecimal" resetType="Group" resetGroup="TIPO" calculation="Sum">
		<variableExpression><![CDATA[$F{IMPORTE}]]></variableExpression>
	</variable>
	<group name="TIPO" isStartNewPage="true" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{TIPO}]]></groupExpression>
		<groupHeader>
			<band height="75">
				<staticText>
					<reportElement key="staticText-4" mode="Opaque" x="0" y="60" width="470" height="15" backcolor="#FFFFCC" uuid="432fe11d-3dae-4b4b-9930-788b4cad8869"/>
					<box>
						<pen lineWidth="0.5"/>
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[DETALLE]]></text>
				</staticText>
				<staticText>
					<reportElement key="staticText-5" mode="Opaque" x="470" y="60" width="81" height="15" backcolor="#FFFFCC" uuid="351924be-ca20-49a3-8f43-96ff356d78d0"/>
					<box>
						<pen lineWidth="0.5"/>
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[IMPORTE]]></text>
				</staticText>
				<textField isBlankWhenNull="true">
					<reportElement key="textField-25" x="0" y="37" width="552" height="15" isPrintInFirstWholeBand="true" isPrintWhenDetailOverflows="true" uuid="c58d1b08-e6b3-4ef2-8d14-fa8af8a0fc44"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" size="12" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression><![CDATA["PTO - "+$F{FUENTE_FINANCIAMIENTO}+" AF - "+$F{PERIODO}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement key="staticText-13" x="0" y="0" width="222" height="7" forecolor="#000000" uuid="fe4b825f-cdd9-4c9e-ae95-290b419cce9f"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial" size="5" isBold="true" pdfFontName="Helvetica"/>
					</textElement>
					<text><![CDATA[CUARTEL GENERAL DEL EJÉRCITO - SIPRE]]></text>
				</staticText>
				<staticText>
					<reportElement key="staticText-16" x="0" y="7" width="76" height="7" uuid="c1d04010-b1ed-4a91-9fb3-7590d159c775"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement>
						<font fontName="Arial" size="5"/>
					</textElement>
					<text><![CDATA[UEO0002]]></text>
				</staticText>
				<textField evaluationTime="Page" isBlankWhenNull="false">
					<reportElement key="textField-3" x="477" y="0" width="65" height="7" isPrintWhenDetailOverflows="true" uuid="ea3fb776-996a-4cf5-81c5-8b5d7251575e"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="5" isBold="false" pdfFontName="Helvetica"/>
					</textElement>
					<textFieldExpression><![CDATA["Página : "+$V{PAGE_NUMBER} + " de "]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement key="textField" x="352" y="14" width="199" height="8" isPrintWhenDetailOverflows="true" uuid="b40edd55-dbe7-4d88-a573-05d17b7c93c9"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="5"/>
					</textElement>
					<textFieldExpression><![CDATA["Usu. Imp. : "+$F{USU_IMPRESION}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" evaluationTime="Report" isBlankWhenNull="false">
					<reportElement key="textField-2" x="543" y="0" width="9" height="7" isPrintWhenDetailOverflows="true" uuid="cea5acb2-a03f-4d12-9b4c-fff77618840c"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="5" isBold="false" pdfFontName="Helvetica"/>
					</textElement>
					<textFieldExpression><![CDATA["" + $V{PAGE_NUMBER} + ""]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" evaluationTime="Report" pattern="" isBlankWhenNull="false">
					<reportElement key="textField-1" x="357" y="7" width="195" height="8" isPrintWhenDetailOverflows="true" uuid="598145bf-871b-495f-b812-088a4cc26c4b"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="5"/>
					</textElement>
					<textFieldExpression><![CDATA["Fecha Imp. : "+(new java.text.SimpleDateFormat("dd'/'MM'/'yyyy h:mm a",Locale.getDefault())).format(new Date())]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="0" y="22" width="552" height="15" uuid="b78c2d3a-339c-4eed-966d-a4c192d92623"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["RESUMEN DE "+$F{TIPO}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="20">
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement key="textField" x="296" y="0" width="174" height="13" uuid="ecc2847b-4ea4-4154-8842-4ce78688d35e"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font fontName="Arial" size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL"]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="##,###,##0.00" isBlankWhenNull="true">
					<reportElement key="textField" x="470" y="0" width="82" height="13" uuid="d94fc961-417d-48e1-8dc6-e6c893fcecd3"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{SUM_TOTCOB_U}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField" stretchType="RelativeToTallestObject" x="20" y="0" width="390" height="15" uuid="98467b90-b9bb-4119-b69c-cb0cd1b16a03"/>
				<box leftPadding="2" rightPadding="1">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Justified" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{CONCEPTO}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement key="textField" stretchType="RelativeToTallestObject" x="470" y="0" width="82" height="15" uuid="6654ec14-e495-4679-a595-491d725ab40e"/>
				<box rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{IMPORTE}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement key="textField" positionType="Float" stretchType="RelativeToTallestObject" x="0" y="0" width="20" height="15" uuid="ca4cba95-a53a-4207-9e85-99d6a5d45203"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="false" pdfFontName="Helvetica"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TIPO_COUNT}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="410" y="0" width="60" height="15" uuid="8dec8c50-7361-4874-a19a-b407e13af1a9"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{UNIDAD}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
